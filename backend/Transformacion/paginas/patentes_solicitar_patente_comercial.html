<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitud de Patente</title>
    <link href="../recursos/css/bootstrap.min.css" rel="stylesheet">
    <link href="../recursos/css/style.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
            overflow-y: auto;
        }

        .section-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #0d6efd;
        }

        .section-title {
            font-weight: 600;
            color: #343a40;
            margin-bottom: 15px;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }
    </style>
</head>

<body>

    <div class="container-fluid">
        <!-- Tipo de Trámite -->
        <div class="section-card" id="tipoTramiteSection">
            <div class="section-title">Tipo de Trámite</div>
            <div class="row g-3">
                <div class="col-md-4">
                    <select class="form-select" id="tipoTrámite">
                        <option value="">Seleccione...</option>
                    </select>
                </div>
                <div class="col-12 d-none" id="variacionesSection">
                    <label class="form-label mb-2">Especifique:</label>
                    <div id="variacionesContainer" class="d-flex flex-wrap gap-3">
                        <!-- Checkboxes will be injected here -->
                    </div>
                </div>
            </div>
            <div class="mt-3 text-end">
                <button id="btnIniciarTramite" class="btn btn-primary d-none">Iniciar Trámite</button>
            </div>
        </div>

        <div id="form-sections" class="d-none">
            <div class="d-flex justify-content-end mb-3">
                <button class="btn btn-sm btn-danger"
                    onclick="exportElementToPDF('form-sections', 'formulario_patente')">
                    <i data-feather="file-text" class="me-1"></i> Exportar Formulario Completado (PDF)
                </button>
            </div>
            <!-- A. Individualización -->
            <div class="section-card">
                <div class="section-title">A. Individualización del Contribuyente</div>
                <div class="row g-3">
                    <!-- Row 1 -->
                    <div class="col-md-6">
                        <label class="form-label">RUT N°</label>
                        <input type="text" class="form-control" id="rutContribuyente" placeholder="12.345.678-9">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">ROL PATENTE</label>
                        <input type="text" class="form-control" id="rolPatente">
                    </div>

                    <!-- Row 2 -->
                    <div class="col-12">
                        <label class="form-label">NOMBRE O RAZÓN SOCIAL</label>
                        <input type="text" class="form-control" id="nombreRazonSocial">
                    </div>

                    <!-- Row 3 -->
                    <div class="col-12">
                        <label class="form-label">REPRESENTANTE LEGAL</label>
                        <input type="text" class="form-control" id="representanteLegal">
                    </div>

                    <!-- Row 4 -->
                    <div class="col-12">
                        <label class="form-label">DIRECCIÓN COMERCIAL</label>
                        <input type="text" class="form-control" id="direccionComercial">
                    </div>

                    <!-- Row 5 -->
                    <div class="col-12">
                        <label class="form-label">DIRECCIÓN PARTICULAR</label>
                        <input type="text" class="form-control" id="direccionParticular">
                    </div>

                    <!-- Row 6 -->
                    <div class="col-md-6">
                        <label class="form-label">TELÉFONO</label>
                        <input type="tel" class="form-control" id="telefono" placeholder="+56 9 1234 5678">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">ROL AVALÚO</label>
                        <input type="text" class="form-control" id="rolAvaluo">
                    </div>

                    <!-- Row 7 -->
                    <div class="col-12">
                        <label class="form-label">E-MAIL</label>
                        <input type="email" class="form-control" id="email" placeholder="correo@ejemplo.cl">
                    </div>
                </div>
            </div>

            <!-- B. Actividad Económica -->
            <div class="section-card">
                <div class="section-title">B. Actividad Económica y Calidad del Negocio Amparado por esta Patente</div>
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label">GIRO</label>
                        <input type="text" class="form-control" id="giro">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">CÓDIGO ACTIVIDAD S.I.I</label>
                        <input type="text" class="form-control" id="codigoSII">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">CASA MATRIZ</label>
                        <input type="text" class="form-control" id="casaMatriz">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">SUCURSAL</label>
                        <input type="text" class="form-control" id="sucursal">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">INDICAR MUNICIPALIDAD DE CASA MATRIZ SI ES SUCURSAL</label>
                        <input type="text" class="form-control" id="muniCasaMatriz">
                    </div>
                </div>
            </div>

            <!-- C. Patentes Anteriores -->
            <div class="section-card">
                <div class="section-title">C. Detalle Todas las Patentes del Contribuyente</div>

                <!-- Table 1: Viña del Mar -->
                <div class="mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="form-label fw-bold m-0">Patente(s) Comuna Viña del Mar</label>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-success"
                                onclick="exportTableToExcel('tablaVina', 'patentes_vina')">Exportar Excel</button>
                            <button class="btn btn-outline-danger"
                                onclick="exportElementToPDF('tablaVina', 'patentes_vina')">Exportar PDF</button>
                        </div>
                    </div>
                    <table class="table table-bordered table-sm" id="tablaVina">
                        <thead class="table-light">
                            <tr>
                                <th>ROL PATENTE</th>
                                <th>N° TRABAJADORES</th>
                                <th>COMUNA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="form-control form-control-sm" id="vinaRol_0"></td>
                                <td><input type="number" class="form-control form-control-sm" id="vinaTrabajadores_0">
                                </td>
                                <td><input type="text" class="form-control form-control-sm" value="Viña del Mar"
                                        readonly disabled></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-sm btn-outline-secondary" id="btnAddVina">+ Agregar Patente Viña del
                        Mar</button>
                </div>

                <!-- Table 2: Otras Comunas -->
                <div>
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="form-label fw-bold m-0">Patente(s) Otras Comunas</label>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-success"
                                onclick="exportTableToExcel('tablaOtras', 'patentes_otras')">Exportar Excel</button>
                            <button class="btn btn-outline-danger"
                                onclick="exportElementToPDF('tablaOtras', 'patentes_otras')">Exportar PDF</button>
                        </div>
                    </div>
                    <table class="table table-bordered table-sm" id="tablaOtras">
                        <thead class="table-light">
                            <tr>
                                <th>ROL PATENTE</th>
                                <th>COMUNA</th>
                                <th>N° TRABAJADORES</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="form-control form-control-sm" id="otraRol_0"></td>
                                <td><input type="text" class="form-control form-control-sm" id="otraComuna_0"></td>
                                <td><input type="number" class="form-control form-control-sm" id="otraTrabajadores_0">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-sm btn-outline-secondary" id="btnAddOtras">+ Agregar Patente Otra
                        Comuna</button>
                </div>
            </div>

            <!-- D. Propaganda -->
            <div class="section-card">
                <div class="section-title">D. Declaración de Propaganda</div>
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label">LUMINOSA</label>
                        <input type="text" class="form-control" id="propagandaLuminosa">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">NO LUMINOSA</label>
                        <input type="text" class="form-control" id="propagandaNoLuminosa">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">TOTAL MTS CUADRADOS</label>
                        <input type="number" class="form-control" id="propagandaTotalM2">
                    </div>
                </div>
            </div>

            <!-- E. Capital Propio -->
            <div class="section-card">
                <div class="section-title">E. Monto del Capital Propio de la Empresa</div>
                <div class="row">
                    <div class="col-12">
                        <label class="form-label">Suma de Capital Propio ($)</label>
                        <input type="number" class="form-control" id="capitalPropio" placeholder="0">
                    </div>
                </div>
            </div>

            <!-- Firma -->
            <div class="section-card">
                <div class="text-dark fw-bold mb-3">Firma del Contribuyente o Representante Legal</div>
                <div class="border border-2 border-secondary border-dashed p-5 text-center text-muted rounded bg-light"
                    id="seccionFirma">
                    [Espacio para firma digital]
                </div>
            </div>

            <!-- F. Documentación -->
            <div class="section-card">
                <div class="section-title">F. Documentación Necesaria</div>
                <div class="mb-2">Adjunte los documentos requeridos:</div>
                <div class="list-group" id="documentosList">
                    <!-- Dynamic Documents Here -->
                </div>
            </div>

            <div class="d-flex justify-content-end mb-5">
                <button class="btn btn-secondary me-2">Cancelar</button>
                <button class="btn btn-primary btn-lg me-2" onclick="alert('Formulario guardado con éxito.')">Guardar
                    Borrador</button>
                <button class="btn btn-primary btn-lg me-2" onclick="alert('Formulario enviado con éxito.')">Enviar
                    Solicitud</button>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="../recursos/js/export_utils.js"></script>
    <script src="../recursos/js/patentes_solicitar_patente_comercial.js"></script>
<script src='../recursos/js/layout_manager.js'></script>
</body>

</html>
